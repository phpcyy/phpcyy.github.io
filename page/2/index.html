<!DOCTYPE html>
<html lang="zh-CN">
<head>
  <meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=2">
<meta name="theme-color" content="#222">
<meta name="generator" content="Hexo 6.3.0">
  <link rel="apple-touch-icon" sizes="180x180" href="/images/apple-touch-icon-next.png">
  <link rel="icon" type="image/png" sizes="32x32" href="/images/favicon-32x32-next.png">
  <link rel="icon" type="image/png" sizes="16x16" href="/images/favicon-16x16-next.png">
  <link rel="mask-icon" href="/images/logo.svg" color="#222">

<link rel="stylesheet" href="/css/main.css">


<link rel="stylesheet" href="/lib/font-awesome/css/all.min.css">

<script id="hexo-configurations">
    var NexT = window.NexT || {};
    var CONFIG = {"hostname":"www.gonever.com","root":"/","scheme":"Gemini","version":"7.8.0","exturl":false,"sidebar":{"position":"left","display":"post","padding":18,"offset":12,"onmobile":false},"copycode":{"enable":false,"show_result":false,"style":null},"back2top":{"enable":true,"sidebar":false,"scrollpercent":false},"bookmark":{"enable":false,"color":"#222","save":"auto"},"fancybox":false,"mediumzoom":false,"lazyload":false,"pangu":false,"comments":{"style":"tabs","active":null,"storage":true,"lazyload":false,"nav":null},"algolia":{"hits":{"per_page":10},"labels":{"input_placeholder":"Search for Posts","hits_empty":"We didn't find any results for the search: ${query}","hits_stats":"${hits} results found in ${time} ms"}},"localsearch":{"enable":false,"trigger":"auto","top_n_per_article":1,"unescape":false,"preload":false},"motion":{"enable":true,"async":false,"transition":{"post_block":"fadeIn","post_header":"slideDownIn","post_body":"slideDownIn","coll_header":"slideLeftIn","sidebar":"slideUpIn"}}};
  </script>

  <meta property="og:type" content="website">
<meta property="og:title" content="Castle，专属于自己的领地">
<meta property="og:url" content="https://www.gonever.com/page/2/">
<meta property="og:site_name" content="Castle，专属于自己的领地">
<meta property="og:locale" content="zh_CN">
<meta property="article:author" content="Chen Gangyang">
<meta name="twitter:card" content="summary">

<link rel="canonical" href="https://www.gonever.com/page/2/">


<script id="page-configurations">
  // https://hexo.io/docs/variables.html
  CONFIG.page = {
    sidebar: "",
    isHome : true,
    isPost : false,
    lang   : 'zh-CN'
  };
</script>

  <title>Castle，专属于自己的领地</title>
  






  <noscript>
  <style>
  .use-motion .brand,
  .use-motion .menu-item,
  .sidebar-inner,
  .use-motion .post-block,
  .use-motion .pagination,
  .use-motion .comments,
  .use-motion .post-header,
  .use-motion .post-body,
  .use-motion .collection-header { opacity: initial; }

  .use-motion .site-title,
  .use-motion .site-subtitle {
    opacity: initial;
    top: initial;
  }

  .use-motion .logo-line-before i { left: initial; }
  .use-motion .logo-line-after i { right: initial; }
  </style>
</noscript>

</head>

<body itemscope itemtype="http://schema.org/WebPage">
  <div class="container use-motion">
    <div class="headband"></div>

    <header class="header" itemscope itemtype="http://schema.org/WPHeader">
      <div class="header-inner"><div class="site-brand-container">
  <div class="site-nav-toggle">
    <div class="toggle" aria-label="切换导航栏">
      <span class="toggle-line toggle-line-first"></span>
      <span class="toggle-line toggle-line-middle"></span>
      <span class="toggle-line toggle-line-last"></span>
    </div>
  </div>

  <div class="site-meta">

    <a href="/" class="brand" rel="start">
      <span class="logo-line-before"><i></i></span>
      <h1 class="site-title">Castle，专属于自己的领地</h1>
      <span class="logo-line-after"><i></i></span>
    </a>
      <p class="site-subtitle" itemprop="description">我的沉思、笔记和回忆</p>
  </div>

  <div class="site-nav-right">
    <div class="toggle popup-trigger">
    </div>
  </div>
</div>




<nav class="site-nav">
  <ul id="menu" class="main-menu menu">
        <li class="menu-item menu-item-home">

    <a href="/" rel="section"><i class="fa fa-home fa-fw"></i>首页</a>

  </li>
        <li class="menu-item menu-item-tags">

    <a href="/tags/" rel="section"><i class="fa fa-tags fa-fw"></i>标签</a>

  </li>
        <li class="menu-item menu-item-archives">

    <a href="/archives/" rel="section"><i class="fa fa-archive fa-fw"></i>归档</a>

  </li>
  </ul>
</nav>




</div>
    </header>

    
  <div class="back-to-top">
    <i class="fa fa-arrow-up"></i>
    <span>0%</span>
  </div>


    <main class="main">
      <div class="main-inner">
        <div class="content-wrap">
          

          <div class="content index posts-expand">
            
      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="zh-CN">
    <link itemprop="mainEntityOfPage" href="https://www.gonever.com/2021/08/06/%E8%A7%82%E6%B5%B7/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="Chen Gangyang">
      <meta itemprop="description" content="">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Castle，专属于自己的领地">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/2021/08/06/%E8%A7%82%E6%B5%B7/" class="post-title-link" itemprop="url">观海</a>
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">发表于</span>

              <time title="创建时间：2021-08-06 17:36:27" itemprop="dateCreated datePublished" datetime="2021-08-06T17:36:27+08:00">2021-08-06</time>
            </span>
              <span class="post-meta-item">
                <span class="post-meta-item-icon">
                  <i class="far fa-calendar-check"></i>
                </span>
                <span class="post-meta-item-text">更新于</span>
                <time title="修改时间：2023-03-09 15:02:42" itemprop="dateModified" datetime="2023-03-09T15:02:42+08:00">2023-03-09</time>
              </span>

          

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <p>清风拂南浦，微浪拍青泥。<br>赤霞惊走蟹，白鹭喜衔鱼。<br>细沙滚顽儿，阔海逐姝女。<br>遥遥万里梦，今夕似往夕。</p>

      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="zh-CN">
    <link itemprop="mainEntityOfPage" href="https://www.gonever.com/2021/04/09/2021%20%E5%B9%B4%E7%AC%AC%E4%B8%80%E5%AD%A3%E5%BA%A6%E6%80%BB%E7%BB%93/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="Chen Gangyang">
      <meta itemprop="description" content="">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Castle，专属于自己的领地">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/2021/04/09/2021%20%E5%B9%B4%E7%AC%AC%E4%B8%80%E5%AD%A3%E5%BA%A6%E6%80%BB%E7%BB%93/" class="post-title-link" itemprop="url">2021 年第一季度总结</a>
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">发表于</span>

              <time title="创建时间：2021-04-09 13:38:11" itemprop="dateCreated datePublished" datetime="2021-04-09T13:38:11+08:00">2021-04-09</time>
            </span>
              <span class="post-meta-item">
                <span class="post-meta-item-icon">
                  <i class="far fa-calendar-check"></i>
                </span>
                <span class="post-meta-item-text">更新于</span>
                <time title="修改时间：2023-03-08 12:00:41" itemprop="dateModified" datetime="2023-03-08T12:00:41+08:00">2023-03-08</time>
              </span>

          

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <h2 id="阅读"><a href="#阅读" class="headerlink" title="阅读"></a>阅读</h2><p>书籍名称</p>
<p>进度</p>
<p>《十日谈》</p>
<p>100%</p>
<p>《中国人史纲》</p>
<p>90%</p>
<p>《Java 编程思想》</p>
<p>25%</p>
<p>《黑客与画家》</p>
<p>40%</p>
<p>目标</p>
<p>600%</p>
<p>实际</p>
<p>255%</p>
<p>完成情况</p>
<p>42.5%</p>
<p>回顾：第 1 个季度的阅读情况完成较差，需要考虑如何有效完成以上目标。</p>
<p>未完成目标的主要原因是：</p>
<ol>
<li>阅读不够积极，没有足够的兴趣和动力进行阅读，需要经常自省，反思自己；</li>
<li>阅读需要一定的条件，微信读书收费，纸质书不能常伴左右，需要购买会员或者通过其他渠道进行阅读。</li>
</ol>
<p>需要做的事情：</p>
<ol>
<li>周期性总结和反思自己的阅读进度和阅读目标，沉下心来思考阅读的意义和阅读的启示</li>
<li>考虑将纸质书随身携带，或者在 QQ 阅读、Kindle 等阅读器上进行阅读</li>
</ol>
<h2 id="学习外语"><a href="#学习外语" class="headerlink" title="学习外语"></a>学习外语</h2><p>事项</p>
<p>进度</p>
<p>打卡次数</p>
<p>90</p>
<p>目标</p>
<p>85</p>
<p>完成进度</p>
<p>105%</p>
<p>回顾：<br>由于背单词的习惯已经在 2020 年开始，并持续了很长一段时间，因此已经能很好地坚持每天背单词。单词本确实拥有良好的效果，但是会延长外语的学习时间。建议每日固定有限个的单词本背单词的个数，提高可执行性。</p>
<p>需要做的事情：</p>
<ol>
<li>确定每日单词本背单词个数</li>
<li>选一个合适的背包，每天坚持携带单词本</li>
</ol>
<h2 id="记录与分享"><a href="#记录与分享" class="headerlink" title="记录与分享"></a>记录与分享</h2><p>回顾：本周期内除了 2021 年 Flag 外未有其他博客更新。</p>
<p>未完成目标的原因：思考不足，没有惩戒行为。</p>
<p>需要做的事情：</p>
<ol>
<li>坚持每日小记，通过每日至少一句话的形式培养写作习惯，并在有灵感和时间时形成真正的文章</li>
<li>加强截止日的紧迫感，截止日之前未完成应该有相应的惩戒行为</li>
</ol>
<h2 id="控制情绪"><a href="#控制情绪" class="headerlink" title="控制情绪"></a>控制情绪</h2><p>事项</p>
<p>进度</p>
<p>火花次数</p>
<p>1</p>
<p>目标</p>
<p>&lt;&#x3D; 3</p>
<p>完成进度</p>
<p>300%</p>
<p>回顾： 本周期内与他人有火花的次数为 1 次，比较好的做到了与他人沟通保持良好的状态。</p>
<p>需要做的事情：<br>继续在交流时整理情绪，保持正常的心态。</p>
<h3 id="注重家庭"><a href="#注重家庭" class="headerlink" title="注重家庭"></a>注重家庭</h3><p>事项</p>
<p>进度</p>
<p>目标</p>
<p>是否完成</p>
<p>沟通</p>
<p>1 月 1次</p>
<p>1月 1 次</p>
<p>是</p>
<p>纪念日准备</p>
<p>&#x2F;</p>
<p>&#x2F;</p>
<p>&#x2F;</p>
<p>吵架次数</p>
<p>1</p>
<p>1.5</p>
<p>是</p>
<p>回顾：<br>基本还做的可以。</p>
<p>需要做的事情：</p>
<p>目标修改为每个月有效沟通一次。<br>增加打扫目标，每 2 周至少做一次大扫除。</p>
<h2 id="保持运动"><a href="#保持运动" class="headerlink" title="保持运动"></a>保持运动</h2><p>事项</p>
<p>完成次数</p>
<p>目标</p>
<p>完成进度</p>
<p>健身</p>
<p>32</p>
<p>37.5</p>
<p>85.33%</p>
<p>体重</p>
<p>127</p>
<p>120-130</p>
<p>100%</p>
<p>回顾：<br>本周期内做到了冬练三九，比较好地完成了目标。</p>
<p>问题：</p>
<ol>
<li>下雨天锻炼问题</li>
<li>假期内锻炼问题</li>
<li>睡眠问题</li>
</ol>
<p>结论：<br>下雨天如果是工作日，则在公司健身房进行锻炼；<br>下雨天如果是休息日，则改为散步或者挪到工作日进行锻炼；<br>假期内超过 15000 步，且在公园或者绿地等休闲场所连续运动超过 5000 步认为完成了运动（走路、跑步、爬山皆可）</p>
<h2 id="作息规律"><a href="#作息规律" class="headerlink" title="作息规律"></a>作息规律</h2><p>事项</p>
<p>完成次数</p>
<p>目标</p>
<p>完成进度</p>
<p>早睡早起</p>
<p>55</p>
<p>75</p>
<p>73%</p>
<p>回顾：<br>早睡早起与锻炼身体密切相关，基本在努力做到作息规律，但是楼上楼下的噪音是最大困扰。</p>
<p>结论：<br>早睡早起基本做到了，要想完全做到的话搬到一个安静的小区或者找到如何在嘈杂的环境中入睡是最迫切的事情，没有办法在牺牲睡眠的情况下去做其他事情。不过，做到了早睡早起的日子里，在多出来的时间中应该做些什么，值得认真思考。</p>
<h2 id="看看世界"><a href="#看看世界" class="headerlink" title="看看世界"></a>看看世界</h2><p>本周期内未完成远游，但是去了世纪公园、中山公园等地方，2 次去看房，1 次春节，基本做到了周末没有呆在家中。</p>
<h2 id="提升技术"><a href="#提升技术" class="headerlink" title="提升技术"></a>提升技术</h2><p>事项</p>
<p>完成次数</p>
<p>目标</p>
<p>完成进度</p>
<p>分享技术</p>
<p>0</p>
<p>3</p>
<p>0%</p>
<p>Leetcode 刷题</p>
<p>13</p>
<p>12.5</p>
<p>100%</p>
<p>回顾： 本周期内分享技术完全没有做到，Leetcode 刷题 全部完成。</p>
<p>问题： 没有思考，未能及时将学习的知识点进行记录与分享。</p>
<p>需要做的事情：学习知识时及时落下来，弄懂弄通并在分享中巩固知识。</p>
<h2 id="总结"><a href="#总结" class="headerlink" title="总结"></a>总结</h2><p>一半的事情如期在进行，还不错，值的鼓励，但是做事要踏实，对得起自己，不能敷衍。</p>
<p>以下几点作为提高点去进一步执行：</p>
<ol>
<li>读书需沉下心来，多想想读书的意义，保持积极蓬勃的心态；可以通过 Kindle 和 QQ 阅读等 APP 去跳过无法阅读的困境，或者直接付费；随身携带背包，将要读的书带在身边。</li>
<li>随身携带单词本，每天通过单词本背单词 6 个左右。</li>
<li>每日小记，培养写作习惯，如果一个月未更新博客，罚跑 5 公里一次。</li>
<li>交流时整理情绪，保持良好心态。</li>
<li>给家人打电话时做到有效沟通，温暖、积极、平衡；每 2 周做一次大扫除；准备纪念日。</li>
<li>开始学习游泳，继续坚持健身。</li>
<li>考虑搬家或者找到嘈杂环境中睡眠的方案，早起如果不健身的时候要读书、写字或者整理房间。</li>
<li>准备做一次远游规划。</li>
<li>学习知识点时做笔记，并分享。</li>
<li>月底时应该思考本月的完成情况，心中有数。</li>
</ol>

      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="zh-CN">
    <link itemprop="mainEntityOfPage" href="https://www.gonever.com/2021/02/04/TarsBenchmark%20%E4%BD%BF%E7%94%A8%E6%8C%87%E5%8D%97/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="Chen Gangyang">
      <meta itemprop="description" content="">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Castle，专属于自己的领地">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/2021/02/04/TarsBenchmark%20%E4%BD%BF%E7%94%A8%E6%8C%87%E5%8D%97/" class="post-title-link" itemprop="url">TarsBenchmark 使用指南</a>
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">发表于</span>

              <time title="创建时间：2021-02-04 10:38:26" itemprop="dateCreated datePublished" datetime="2021-02-04T10:38:26+08:00">2021-02-04</time>
            </span>
              <span class="post-meta-item">
                <span class="post-meta-item-icon">
                  <i class="far fa-calendar-check"></i>
                </span>
                <span class="post-meta-item-text">更新于</span>
                <time title="修改时间：2023-03-09 14:42:44" itemprop="dateModified" datetime="2023-03-09T14:42:44+08:00">2023-03-09</time>
              </span>

          

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <p>TarsBenchmark 可以用来压测 tars 服务，方便测试服务的性能。TarsBenchmark 主要依赖 tars2case 命令和 tb 命令。</p>
<p>tars2case 命令用于生成测试用例，tb 命令用来进行压测。</p>
<h2 id="构建环境"><a href="#构建环境" class="headerlink" title="构建环境"></a>构建环境</h2><p>可以根据以下的 dockerfile 手动构建镜像，然后根据镜像生成容器。</p>
<figure class="highlight docker"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">FROM</span> golang:latest</span><br><span class="line"><span class="keyword">RUN</span><span class="language-bash"> apt update &amp;&amp; apt install cmake bison flex zlib1g-dev -y &amp;&amp; <span class="built_in">rm</span> -rf /var/lib/apt/lists/*</span></span><br><span class="line"><span class="keyword">RUN</span><span class="language-bash"> <span class="built_in">cd</span> /root &amp;&amp; git <span class="built_in">clone</span> https://github.com/TarsCloud/TarsCpp.git --recursive &amp;&amp; <span class="built_in">mkdir</span> -p /root/TarsCpp/build &amp;&amp; <span class="built_in">cd</span> /root/TarsCpp/build  &amp;&amp; cmake .. &amp;&amp; make install &amp;&amp;  <span class="built_in">cd</span> /root &amp;&amp; git <span class="built_in">clone</span> https://github.com/TarsCloud/TarsBenchmark.git &amp;&amp; <span class="built_in">mkdir</span> -p /root/TarsBenchmark/build &amp;&amp; <span class="built_in">cd</span> /root/TarsBenchmark/build &amp;&amp; cmake .. &amp;&amp; make all &amp;&amp; <span class="built_in">export</span> PATH=<span class="variable">$PATH</span>:/usr/local/tars/cpp/tools:/root/TarsBenchmark/build/bin</span></span><br></pre></td></tr></table></figure>

<p>或者直接利用现有镜像,</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">docker run -td --name golang golang:latest</span><br><span class="line">docker exec -it golang bash</span><br></pre></td></tr></table></figure>

<p>进入容器后执行:</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">apt update &amp;&amp; apt install cmake bison flex zlib1g-dev &amp;&amp; rm -rf /var/lib/apt/lists/*</span><br><span class="line">cd /root &amp;&amp; git clone https://github.com/TarsCloud/TarsCpp.git --recursive &amp;&amp; mkdir -p /root/TarsCpp/build &amp;&amp; cd /root/TarsCpp/build  &amp;&amp; cmake .. &amp;&amp; make install &amp;&amp;  cd /root &amp;&amp; git clone https://github.com/TarsCloud/TarsBenchmark.git &amp;&amp; mkdir -p /root/TarsBenchmark/build &amp;&amp; cd /root/TarsBenchmark/build &amp;&amp; cmake .. &amp;&amp; make all &amp;&amp; export PATH=$PATH:/usr/local/tars/cpp/tools:/root/TarsBenchmark/build/bin</span><br></pre></td></tr></table></figure>

<h2 id="生成用例文件"><a href="#生成用例文件" class="headerlink" title="生成用例文件"></a>生成用例文件</h2><p>例如你的 Tars 文件是这样的，名字为 test.tars</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">module Test &#123;</span><br><span class="line">    interface Greet &#123;</span><br><span class="line">        void Hello(string text, out string response);</span><br><span class="line">    &#125;;</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure>

<p>进入 docker 容器，执行</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">tars2case --json test.tars --dir=.</span><br></pre></td></tr></table></figure>

<p>得到如下文件</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">|-- Hello.case</span><br><span class="line">|-- Hello.desc</span><br><span class="line">`-- test.tars</span><br></pre></td></tr></table></figure>

<p>每个方法会生成一个对应的 desc 和 case 文件，前者为描述文件，后者为测试用例。</p>
<p>Hello.desc</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&#123; &quot;1_text_string&quot;: &quot;&quot; &#125;</span><br></pre></td></tr></table></figure>

<p>Hello.case</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&#123; &quot;text&quot;: &quot;string&quot; &#125;</span><br></pre></td></tr></table></figure>

<h2 id="修改用例内容"><a href="#修改用例内容" class="headerlink" title="修改用例内容"></a>修改用例内容</h2><p>tb 对 tars 结构中 Number 和 string 支持生成随机内容，通过如下两种随机方式(Value 必须以 string)。</p>
<p>&lt;范围随机值&gt;用 [1-100] 表示，表示在 1-100 内随机出现, 必须是数字。<br>&lt;限定随机值&gt;用 [369,aaa,bbb] 表示，表示在 369,aaa,bbb 中随机出现。</p>
<p>例如修改 Hello.case,</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&#123; &quot;text&quot;: &quot;[369, aaa, bbb]&quot; &#125;</span><br></pre></td></tr></table></figure>

<h2 id="执行用例"><a href="#执行用例" class="headerlink" title="执行用例"></a>执行用例</h2><p>执行以下命令开始压测，压测会每隔指定时间展示该段时间内的请求结果，最终会生成汇总结果。</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">tb -c 5 -s 100 -I 60 -D 172.16.1.139 -P 10037 -p json -i 10 -I 60 -S QDINT.BookshelfService.BookshelfObj -M getAllItemList</span><br></pre></td></tr></table></figure>

<p>执行压测时当前目录需要有对应的 .case 和 .desc 的用例文件，上边的命令需要有 getAllItemList.case 和 getAllItemList.desc 这 2 个文件。</p>
<p>参数说明</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">-h                   帮助信息</span><br><span class="line">-c                   连接数量</span><br><span class="line">-D                   压测服务器IP，多个IP用&#x27;;&#x27;区隔</span><br><span class="line">-P                   网络传输端口</span><br><span class="line">-p                   接口通信协议(tars|http)</span><br><span class="line">-t(可选)             单个请求超时时间，默认3秒</span><br><span class="line">-T(可选)             网络层协议，默认tcp</span><br><span class="line">-I(可选)             压测持续时间(单位秒)，默认1H</span><br><span class="line">-i(可选)             控制台打印周期时间(单位秒)，默认10秒</span><br><span class="line">-s(可选)             最大速率限制，为空或0表示自动适配服务最佳速率</span><br><span class="line">-n(可选)             最大压测进程限制，默认跟CPU核心数</span><br></pre></td></tr></table></figure>

      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="zh-CN">
    <link itemprop="mainEntityOfPage" href="https://www.gonever.com/2021/01/01/2021%20%E6%96%B0%E5%B9%B4%20Flag/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="Chen Gangyang">
      <meta itemprop="description" content="">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Castle，专属于自己的领地">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/2021/01/01/2021%20%E6%96%B0%E5%B9%B4%20Flag/" class="post-title-link" itemprop="url">2021 新年 Flag</a>
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">发表于</span>

              <time title="创建时间：2021-01-01 10:14:48" itemprop="dateCreated datePublished" datetime="2021-01-01T10:14:48+08:00">2021-01-01</time>
            </span>
              <span class="post-meta-item">
                <span class="post-meta-item-icon">
                  <i class="far fa-calendar-check"></i>
                </span>
                <span class="post-meta-item-text">更新于</span>
                <time title="修改时间：2023-02-27 21:18:35" itemprop="dateModified" datetime="2023-02-27T21:18:35+08:00">2023-02-27</time>
              </span>

          

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <ol>
<li>坚持阅读，阅读 4 本技术书籍，总共 24 本书籍</li>
<li>学习外语， 利用单词 APP 和单词本背单词，打卡 340 次以上</li>
<li>记录与分享，博客更新 24 篇左右，感悟、思考、技术均可</li>
<li>控制情绪，与人沟通保持良好的状态，降低交流时的压迫感，记录到的有火花的交流次数少于 12 次</li>
<li>注重家庭，家务当日事当日毕，纪念日、生日有准备，因自己不当行为导致的吵架次数低于 6 次，与双方父母至少每月沟通一次</li>
<li>保持运动，健身 150 次以上，学会游泳，保持体重，体重继续控制在 120 到 130 斤之间</li>
<li>作息规律， 按时作息，11点半睡觉，7 点起床，300 次以上</li>
<li>看看世界，远游至少 2 次，日本 + 新疆，如果疫情原因日本仍不能成行，则去九寨沟或云南</li>
<li>提升技术，每个月学习一个新的技术点并分享到博客，完成 50 道中等及以上难度算法题</li>
<li>按时总结，看一下 2021 年目标的执行情况，而非 2022 才发现一个都没做</li>
<li>…</li>
</ol>

      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="zh-CN">
    <link itemprop="mainEntityOfPage" href="https://www.gonever.com/2020/11/18/MacOS%20%E5%8D%87%E7%BA%A7%20Big%20Sur%20%E9%81%87%E5%88%B0%E7%9A%84%E9%97%AE%E9%A2%98%E5%8F%8A%E8%A7%A3%E5%86%B3%E5%8A%9E%E6%B3%95/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="Chen Gangyang">
      <meta itemprop="description" content="">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Castle，专属于自己的领地">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/2020/11/18/MacOS%20%E5%8D%87%E7%BA%A7%20Big%20Sur%20%E9%81%87%E5%88%B0%E7%9A%84%E9%97%AE%E9%A2%98%E5%8F%8A%E8%A7%A3%E5%86%B3%E5%8A%9E%E6%B3%95/" class="post-title-link" itemprop="url">MacOS 升级 Big Sur 遇到的问题及解决办法</a>
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">发表于</span>

              <time title="创建时间：2020-11-18 14:13:24" itemprop="dateCreated datePublished" datetime="2020-11-18T14:13:24+08:00">2020-11-18</time>
            </span>
              <span class="post-meta-item">
                <span class="post-meta-item-icon">
                  <i class="far fa-calendar-check"></i>
                </span>
                <span class="post-meta-item-text">更新于</span>
                <time title="修改时间：2023-03-09 18:32:20" itemprop="dateModified" datetime="2023-03-09T18:32:20+08:00">2023-03-09</time>
              </span>

          

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <p>Apple 最近发布了 Big Sur，由于实在是受不了小红点，就尝鲜升级到了新版本的系统。然而，还是遇到了很多问题。</p>
<h2 id="2K-显示屏字体过小问题"><a href="#2K-显示屏字体过小问题" class="headerlink" title="2K 显示屏字体过小问题"></a>2K 显示屏字体过小问题</h2><p>这个问题其实在上个版本我就遇到过，没想到升级了系统后再次遇到了该问题。</p>
<p>好在回忆起来在 v2ex 上看过该问题的解决方法，github 上的 <a target="_blank" rel="noopener" href="https://github.com/xzhih/one-key-hidpi/blob/master/README-zh.md">一键开启 macOS HiDPI</a> 可以解决该问题。</p>
<p>执行</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">bash -c &quot;$(curl -fsSL https://raw.githubusercontent.com/xzhih/one-key-hidpi/master/hidpi.sh)&quot;</span><br></pre></td></tr></table></figure>

<p>第一步选择<code>开启 HIDPI</code>，之后选择 <code>保持原样</code>，再之后选择 <code>手动输入分辨率</code>，最后输入分辨率 <code>2048x1152</code>，然后就可以了。</p>
<p>这样显示器既可以看起来字体大小正常，又不会字体模糊。</p>
<h2 id="键盘失灵问题"><a href="#键盘失灵问题" class="headerlink" title="键盘失灵问题"></a>键盘失灵问题</h2><p>升级了系统之后，Macbook Pro 自带的键盘和外接键盘全部失灵。所幸的是外接键盘拔掉之后重新连接，还能正常使用。而原生键盘则无法正常使用。</p>
<p>考虑到开机输入密码时，键盘还能正常输入，遂认为是软件引起的问题，马上想到了自己有安装 <code>Karabiner Elements</code>，所以尝试将其卸载。</p>
<p>在 Applications 目录直接删除 Karabiner Elements 会遇到 <code>The operation can’t be completed because the item “Karabiner-EventViewer.app” is locked.</code>，造成无法删除。</p>
<p>可以先打开 Karabiner Elements ，在 Misc 菜单中有 Uninstall 选项，输入密码完成卸载即可。</p>
<p>卸载完成后重启电脑，键盘果然恢复正常使用。</p>
<h2 id="顶部菜单栏空白间隔过大问题"><a href="#顶部菜单栏空白间隔过大问题" class="headerlink" title="顶部菜单栏空白间隔过大问题"></a>顶部菜单栏空白间隔过大问题</h2><p>最后一个非常影响外观的问题就是顶部菜单栏的图标中间有个巨大的间隔，尝试退出很多软件都无法解决。</p>
<p>最后经过搜索发现是搜狗输入法的问题，升级搜狗输入法，该问题即可解决。</p>
<h2 id="网易-Mumu-模拟器"><a href="#网易-Mumu-模拟器" class="headerlink" title="网易 Mumu 模拟器"></a>网易 Mumu 模拟器</h2><p>更新系统后，网易 Mumu 模拟器也不能正常工作了，表现为提示驱动安装失败。</p>
<p>卸载并重新安装后，应用恢复正常。</p>
<p>需要注意的是，在安装 Helper 后，需要在安全与隐私设置中进行同意。</p>

      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="zh-CN">
    <link itemprop="mainEntityOfPage" href="https://www.gonever.com/2020/09/30/mysqlshow%20%E2%80%94%E2%80%94%20%E5%BF%AB%E9%80%9F%E8%8E%B7%E5%8F%96%20MySQL%20%E7%9A%84%E5%BA%93%E3%80%81%E8%A1%A8%E3%80%81%E5%88%97%E5%92%8C%E7%B4%A2%E5%BC%95%E4%BF%A1%E6%81%AF/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="Chen Gangyang">
      <meta itemprop="description" content="">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Castle，专属于自己的领地">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/2020/09/30/mysqlshow%20%E2%80%94%E2%80%94%20%E5%BF%AB%E9%80%9F%E8%8E%B7%E5%8F%96%20MySQL%20%E7%9A%84%E5%BA%93%E3%80%81%E8%A1%A8%E3%80%81%E5%88%97%E5%92%8C%E7%B4%A2%E5%BC%95%E4%BF%A1%E6%81%AF/" class="post-title-link" itemprop="url">mysqlshow —— 快速获取 MySQL 的库、表、列和索引信息</a>
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">发表于</span>

              <time title="创建时间：2020-09-30 16:50:14" itemprop="dateCreated datePublished" datetime="2020-09-30T16:50:14+08:00">2020-09-30</time>
            </span>
              <span class="post-meta-item">
                <span class="post-meta-item-icon">
                  <i class="far fa-calendar-check"></i>
                </span>
                <span class="post-meta-item-text">更新于</span>
                <time title="修改时间：2023-03-15 09:35:42" itemprop="dateModified" datetime="2023-03-15T09:35:42+08:00">2023-03-15</time>
              </span>

          

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <p>大部分开源应用都是用了 MySQL 数据库。了解如何获取 MySQL 数据库的高阶信息，对于调试开源应用程序非常重要。在这篇文章中，我将用 9 个例子来说明如何查看任何 MySQL 数据库的数据库、表、列和索引的信息。</p>
<p>在接下来的 mysqlshow 示例中，你可以通过以下 2 种方式的任何一种来输入密码：</p>
<ul>
<li><p>在 <code>mysqlshow</code> 命令后紧跟密码（不要输入任何空格）。在你直接使用 shell 脚本时很有用。</p>
</li>
<li><p>在 <code>mysqlshow</code> 命令后仅仅输入 <code>-p</code> 选项，但不输入密码，之后会提示你输入密码。当你从命令行中交互式地使用 <code>mysqlshow</code> 命令时，推荐使用这种方式。</p>
</li>
</ul>
<h2 id="1-列出所有可用的数据库"><a href="#1-列出所有可用的数据库" class="headerlink" title="1. 列出所有可用的数据库"></a>1. 列出所有可用的数据库</h2><p>请将 「 tmppassword 」 替换成你的 MySQL 数据库的 root 用户密码。</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"># mysqlshow  -u root -ptmppassword</span><br><span class="line"></span><br><span class="line">+--------------------+</span><br><span class="line">|     Databases      |</span><br><span class="line">+--------------------+</span><br><span class="line">| information_schema |</span><br><span class="line">| mysql              |</span><br><span class="line">| sugarcrm           |</span><br><span class="line">+--------------------+</span><br></pre></td></tr></table></figure>

<h2 id="2-列出数据库中的所有表"><a href="#2-列出数据库中的所有表" class="headerlink" title="2. 列出数据库中的所有表"></a>2. 列出数据库中的所有表</h2><p>下边这个示例会列出 sugarcrm 数据库中的所有表。</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"># mysqlshow  -u root -ptmppassword sugarcrm</span><br><span class="line"></span><br><span class="line">Database: sugarcrm</span><br><span class="line">+--------------------------------+</span><br><span class="line">|             Tables             |</span><br><span class="line">+--------------------------------+</span><br><span class="line">| accounts                       |</span><br><span class="line">| accounts_audit                 |</span><br><span class="line">| accounts_bugs                  |</span><br><span class="line">+--------------------------------+</span><br></pre></td></tr></table></figure>

<h2 id="3-列出数据库中的所有表并附带每张表的列数"><a href="#3-列出数据库中的所有表并附带每张表的列数" class="headerlink" title="3. 列出数据库中的所有表并附带每张表的列数"></a>3. 列出数据库中的所有表并附带每张表的列数</h2><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"># mysqlshow  -v -u root -p sugarcrm</span><br><span class="line"></span><br><span class="line">Enter password:</span><br><span class="line">Database: sugarcrm</span><br><span class="line">+--------------------------------+----------+</span><br><span class="line">|             Tables             | Columns  |</span><br><span class="line">+--------------------------------+----------+</span><br><span class="line">| accounts                       |       33 |</span><br><span class="line">| accounts_audit                 |       10 |</span><br><span class="line">| accounts_bugs                  |        5 |</span><br><span class="line">+-------------------------------------------+</span><br></pre></td></tr></table></figure>

<h2 id="4-列出数据库中的所有表并附带每张表的列数和行数"><a href="#4-列出数据库中的所有表并附带每张表的列数和行数" class="headerlink" title="4. 列出数据库中的所有表并附带每张表的列数和行数"></a>4. 列出数据库中的所有表并附带每张表的列数和行数</h2><p>请记住下边这个命令要输入 2 个 <code>-v</code>。</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"># mysqlshow  -v -v -u root -p sugarcrm</span><br><span class="line"></span><br><span class="line">Enter password:</span><br><span class="line">Database: sugarcrm</span><br><span class="line">+--------------------------------+----------+------------+</span><br><span class="line">|             Tables             | Columns  | Total Rows |</span><br><span class="line">+--------------------------------+----------+------------+</span><br><span class="line">| accounts                       |       33 |        252 |</span><br><span class="line">| accounts_audit                 |       10 |         63 |</span><br><span class="line">| accounts_bugs                  |        5 |          0 |</span><br><span class="line">+---------------------------------------------------------+</span><br></pre></td></tr></table></figure>

<h2 id="5-列出某表的所有列"><a href="#5-列出某表的所有列" class="headerlink" title="5.列出某表的所有列"></a>5.列出某表的所有列</h2><p>这个示例中，显示了 sugarcrm 库中的 accounts 表的所有可用的列名和该列其他信息。</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"># mysqlshow  -u root -ptmppassword sugarcrm accounts id</span><br><span class="line"></span><br><span class="line">Database: sugarcrm  Table: accounts  Wildcard: id</span><br><span class="line">+-------+----------+-----------------+------+-----+---------+-------+---------------------------------+---------+</span><br><span class="line">| Field | Type     | Collation       | Null | Key | Default | Extra | Privileges                      | Comment |</span><br><span class="line">+-------+----------+-----------------+------+-----+---------+-------+---------------------------------+---------+</span><br><span class="line">| id    | char(36) | utf8_general_ci | NO   | PRI |         |       | select,insert,update,references |         |</span><br><span class="line">+-------+----------+-----------------+------+-----+---------+-------+---------------------------------+---------+</span><br></pre></td></tr></table></figure>

<h2 id="6-列出某表的某列的详细信息"><a href="#6-列出某表的某列的详细信息" class="headerlink" title="6. 列出某表的某列的详细信息"></a>6. 列出某表的某列的详细信息</h2><p>在这个示例中，列出了 accounts 表的 id 列的信息。</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"># mysqlshow  -u root -ptmppassword sugarcrm accounts id</span><br><span class="line"></span><br><span class="line">Database: sugarcrm  Table: accounts  Wildcard: id</span><br><span class="line">+-------+----------+-----------------+------+-----+---------+-------+---------------------------------+---------+</span><br><span class="line">| Field | Type     | Collation       | Null | Key | Default | Extra | Privileges                      | Comment |</span><br><span class="line">+-------+----------+-----------------+------+-----+---------+-------+---------------------------------+---------+</span><br><span class="line">| id    | char(36) | utf8_general_ci | NO   | PRI |         |       | select,insert,update,references |         |</span><br><span class="line">+-------+----------+-----------------+------+-----+---------+-------+---------------------------------+---------+</span><br></pre></td></tr></table></figure>

<h2 id="7-显示某张表的所有的元信息"><a href="#7-显示某张表的所有的元信息" class="headerlink" title="7. 显示某张表的所有的元信息"></a>7. 显示某张表的所有的元信息</h2><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"># mysqlshow  -i  -u root -ptmppassword sugarcrm accounts</span><br></pre></td></tr></table></figure>

<p>这结汇列出关于 accounts 表的以下所有信息。</p>
<ul>
<li>Name</li>
<li>Engine</li>
<li>Version</li>
<li>Row_format</li>
<li>Rows</li>
<li>Avg_row_length</li>
<li>Data_length</li>
<li>Max_data_length</li>
<li>Index_length</li>
<li>Data_free</li>
<li>Auto_increment</li>
<li>Create_time</li>
<li>Update_time</li>
<li>Check_time</li>
<li>Collation</li>
<li>Checksum</li>
<li>Create_options</li>
<li>Comment</li>
</ul>
<h2 id="8-列出某张表的列和索引信息"><a href="#8-列出某张表的列和索引信息" class="headerlink" title="8. 列出某张表的列和索引信息"></a>8. 列出某张表的列和索引信息</h2><p>请记住索引信息会显示在输出的末尾，列信息的下方。</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"># mysqlshow -k -u root -ptmppassword sugarcrm accounts</span><br><span class="line"></span><br><span class="line">Database: sugarcrm  Table: accounts</span><br><span class="line">+-----------------------------+--------------+-----------------+------+-----+---------+-------+---------------------------------+---------+</span><br><span class="line">| Field                       | Type         | Collation       | Null | Key | Default | Extra | Privileges                      | Comment |</span><br><span class="line">+-----------------------------+--------------+-----------------+------+-----+---------+-------+---------------------------------+---------+</span><br><span class="line">| id                          | char(36)     | utf8_general_ci | NO   | PRI |         |       | select,insert,update,references |         |</span><br><span class="line">| name                        | varchar(150) | utf8_general_ci | YES  |     |         |       | select,insert,update,references |         |</span><br><span class="line">+----------+------------+------------------------+--------------+------------------+-----------+-------------+----------+--------+------+------------+---------+</span><br><span class="line">| Table    | Non_unique | Key_name               | Seq_in_index | Column_name      | Collation | Cardinality | Sub_part | Packed | Null | Index_type | Comment |</span><br><span class="line">+----------+------------+------------------------+--------------+------------------+-----------+-------------+----------+--------+------+------------+---------+</span><br><span class="line">| accounts | 0          | PRIMARY                | 1            | id               | A         | 252         |          |        |      | BTREE      |         |</span><br><span class="line">| accounts | 1          | idx_accnt_id_del       | 1            | id               | A         |             |          |        |      | BTREE      |         |</span><br><span class="line">+----------+------------+------------------------+--------------+------------------+-----------+-------------+----------+--------+------+------------+---------+</span><br></pre></td></tr></table></figure>

<h2 id="9-显示某张表的索引但是不包含列信息"><a href="#9-显示某张表的索引但是不包含列信息" class="headerlink" title="9. 显示某张表的索引但是不包含列信息"></a>9. 显示某张表的索引但是不包含列信息</h2><p>可以通过提供非法的列名来骗过 <code>mysqlshow</code>。因为 <code>invalide_col_name</code> 在 <code>accounts</code> 表中不存在，所以下边这个命令仅会输出 <code>accounts</code> 表的索引信息。</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"># mysqlshow -k -u root -ptmppassword sugarcrm accounts invalid_col_name</span><br><span class="line"></span><br><span class="line">Database: sugarcrm  Table: accounts  Wildcard: invalid_col_name</span><br><span class="line">+-------+------+-----------+------+-----+---------+-------+------------+---------+</span><br><span class="line">| Field | Type | Collation | Null | Key | Default | Extra | Privileges | Comment |</span><br><span class="line">+-------+------+-----------+------+-----+---------+-------+------------+---------+</span><br><span class="line">+-------+------+-----------+------+-----+---------+-------+------------+---------+</span><br><span class="line">+----------+------------+------------------------+--------------+------------------+-----------+-------------+----------+--------+------+------------+---------+</span><br><span class="line">| Table    | Non_unique | Key_name               | Seq_in_index | Column_name      | Collation | Cardinality | Sub_part | Packed | Null | Index_type | Comment |</span><br><span class="line">+----------+------------+------------------------+--------------+------------------+-----------+-------------+----------+--------+------+------------+---------+</span><br><span class="line">| accounts | 0          | PRIMARY                | 1            | id               | A         | 254         |          |        |      | BTREE      |         |</span><br><span class="line">| accounts | 1          | idx_accnt_id_del       | 1            | id               | A         |             |          |        |      | BTREE      |         |</span><br><span class="line">+----------+------------+------------------------+--------------+------------------+-----------+-------------+----------+--------+------+------------+---------+</span><br></pre></td></tr></table></figure>

<h2 id="说明"><a href="#说明" class="headerlink" title="说明"></a>说明</h2><p>本篇文章翻译自 <a target="_blank" rel="noopener" href="https://www.thegeekstuff.com/2008/08/get-quick-info-on-mysql-db-table-column-and-index-using-mysqlshow/">mysqlshow – Get Quick Info On MySQL DB, Table, Column and Index</a>，笔者出于分享的目的翻译了该文章。如有侵权，请联系本人删除本文章。</p>

      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="zh-CN">
    <link itemprop="mainEntityOfPage" href="https://www.gonever.com/2020/09/18/%E5%A6%82%E4%BD%95%E5%B0%86%E4%BD%A0%E7%9A%84%20golang%20%E5%BA%93%E5%8D%87%E7%BA%A7%E5%88%B0%20v2%20%E7%89%88%E6%9C%AC/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="Chen Gangyang">
      <meta itemprop="description" content="">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Castle，专属于自己的领地">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/2020/09/18/%E5%A6%82%E4%BD%95%E5%B0%86%E4%BD%A0%E7%9A%84%20golang%20%E5%BA%93%E5%8D%87%E7%BA%A7%E5%88%B0%20v2%20%E7%89%88%E6%9C%AC/" class="post-title-link" itemprop="url">如何将你的 golang 库升级到 v2 版本</a>
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">发表于</span>

              <time title="创建时间：2020-09-18 16:26:34" itemprop="dateCreated datePublished" datetime="2020-09-18T16:26:34+08:00">2020-09-18</time>
            </span>
              <span class="post-meta-item">
                <span class="post-meta-item-icon">
                  <i class="far fa-calendar-check"></i>
                </span>
                <span class="post-meta-item-text">更新于</span>
                <time title="修改时间：2023-03-15 19:10:14" itemprop="dateModified" datetime="2023-03-15T19:10:14+08:00">2023-03-15</time>
              </span>

          

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <p>如果你用到了一个库的 v2 版本，你依赖的另外一个库用到了该库的 v1 版本，而二者不兼容，该如何处理呢？</p>
<p>我之前在用到比如 <code>github.com/urfave/cli/v2</code> 和 <code>github.com/go-playground/validator/v10</code> 这种库时，经常会看到一个库可以有多个版本，方便做版本的升级。</p>
<p>golang 本身在 1.13 版本后支持通过 go mod 的方式，引入同一个包的不同版本，防止出现交叉引用时出现的不兼容情况。</p>
<h2 id="项目的-v1-版本"><a href="#项目的-v1-版本" class="headerlink" title="项目的 v1 版本"></a>项目的 v1 版本</h2><p>app.go</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">package mod</span><br><span class="line"></span><br><span class="line">func Version() string &#123;</span><br><span class="line">    return &quot;v1&quot;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>go.mod</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">module github.com/phpcyy/mod</span><br></pre></td></tr></table></figure>

<p>将项目打上 tag v1.0.0 并发布。</p>
<h2 id="项目的-v2-版本"><a href="#项目的-v2-版本" class="headerlink" title="项目的 v2 版本"></a>项目的 v2 版本</h2><p>app.go</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">package mod</span><br><span class="line"></span><br><span class="line">func Version() string &#123;</span><br><span class="line">    return &quot;v2&quot;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>go.mod</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">module github.com/phpcyy/mod/v2</span><br></pre></td></tr></table></figure>

<p>将项目打上 tag v2.0.0 并发布。</p>
<h2 id="测试"><a href="#测试" class="headerlink" title="测试"></a>测试</h2><p>在另外一个项目中，执行 <code>go get github.com/phpcyy/mod</code> 和<br><code>go get github.com/phpcyy/mod/v2</code> 来引入不同版本的库。</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">package main</span><br><span class="line"></span><br><span class="line">import (</span><br><span class="line">    &quot;fmt&quot;</span><br><span class="line">    &quot;github.com/phpcyy/mod&quot;</span><br><span class="line">    mod2 &quot;github.com/phpcyy/mod/v2&quot;</span><br><span class="line">)</span><br><span class="line"></span><br><span class="line">func main() &#123;</span><br><span class="line">    fmt.Println(mod.Version())</span><br><span class="line">    fmt.Println(mod2.Version())</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>打印显示</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">v1</span><br><span class="line">v2</span><br></pre></td></tr></table></figure>

<p>这样便可以做到在一个项目中引入一个库的不同版本。</p>
<p>具体代码见于 <a target="_blank" rel="noopener" href="https://github.com/phpcyy/mod">github.com&#x2F;phpcyy&#x2F;mod</a>，可以作为一个小示例。</p>

      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="zh-CN">
    <link itemprop="mainEntityOfPage" href="https://www.gonever.com/2020/07/28/Go%20%E4%BB%A3%E7%A0%81%E9%A3%8E%E6%A0%BC%E6%9C%80%E4%BD%B3%E5%AE%9E%E8%B7%B5/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="Chen Gangyang">
      <meta itemprop="description" content="">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Castle，专属于自己的领地">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/2020/07/28/Go%20%E4%BB%A3%E7%A0%81%E9%A3%8E%E6%A0%BC%E6%9C%80%E4%BD%B3%E5%AE%9E%E8%B7%B5/" class="post-title-link" itemprop="url">Go 代码风格最佳实践</a>
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">发表于</span>

              <time title="创建时间：2020-07-28 19:38:45" itemprop="dateCreated datePublished" datetime="2020-07-28T19:38:45+08:00">2020-07-28</time>
            </span>
              <span class="post-meta-item">
                <span class="post-meta-item-icon">
                  <i class="far fa-calendar-check"></i>
                </span>
                <span class="post-meta-item-text">更新于</span>
                <time title="修改时间：2023-03-10 23:15:55" itemprop="dateModified" datetime="2023-03-10T23:15:55+08:00">2023-03-10</time>
              </span>

          

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <p>今天阅读了<a target="_blank" rel="noopener" href="https://github.com/golang/go/wiki/CodeReviewComments#gofmt">《Go Code Review Comments》</a> 一文，该文明确了 Go 的代码风格，读后很有收获，在这里记录一些要点。</p>
<h2 id="Gofmt"><a href="#Gofmt" class="headerlink" title="Gofmt"></a>Gofmt</h2><p>使用 gofmt 或者 goimports 格式化自己的代码来避免争论。</p>
<h2 id="注释语句"><a href="#注释语句" class="headerlink" title="注释语句"></a>注释语句</h2><p>注释应该是完整的语句，即便看起来有些冗余。这样可以在使用 godoc 生成文档时排版更友好。注释应该以要注释的对象开头，以句号结尾。</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">// Request represents a request to run a command.</span><br><span class="line">type Request struct &#123; ...</span><br><span class="line"></span><br><span class="line">// Encode writes the JSON encoding of req to w.</span><br><span class="line">func Encode(w io.Writer, req *Request) &#123; ...</span><br></pre></td></tr></table></figure>

<h2 id="上下文-Contexts"><a href="#上下文-Contexts" class="headerlink" title="上下文 Contexts"></a>上下文 Contexts</h2><p><code>context.Context</code> 类型携带有认证、trace、deadlines、cancel 信号等信息。在 RPC 和 HTTP 请求中，应该显式地在整个链路中传递 Context。</p>
<p>绝大多数函数的第一个参数应该是 Context:</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">func F(ctx context.Context, /* other arguments */) &#123;&#125;</span><br></pre></td></tr></table></figure>

<p>不要把 Context 作为 struct 的一个属性，而是把 Context 作为 struct method 的第一个参数，有个例外是如果 method 必须<br>要实现某个接口或者某个第三方 pkg 的签名。</p>
<p>在函数参数中不要使用自定义的 Context 类型、不要使用非 Context 包中定义的接口。</p>
<p>如果有参数需要传递，首先要考虑使用函数参数、reciever、全局变量。如果真的需要的话，才放到 Context 中。</p>
<h2 id="复制"><a href="#复制" class="headerlink" title="复制"></a>复制</h2><p>为了避免意想不到的问题，从其他 package 复制 struct 的时候一定要小心。比如说， bytes.Buffer 包含了一个 <code>[]byte</code> 的 slice。如果复制了一个 Buffer，你复制出来的 slice 是源数组的别名，调用后续方法时可能会出现意想不到的问题。</p>
<p>通常情况下，一个叫做 T 的 struct，若其 method receiver 是 *T ，不要复制他。</p>
<h2 id="Crypto-Rand"><a href="#Crypto-Rand" class="headerlink" title="Crypto Rand"></a>Crypto Rand</h2><p>不要使用 <code>math/rand</code> 包来生成秘钥，即使是一次性的。在未 Seed 的情况下，生成的结果完全是可预测的。就算使用了 <code>time.Nanoseconds()</code> 来 Seed，它的熵依旧只有几个 bit。取而代之的是，使用 <code>crypto/rand</code> 包的 Reader。如果你需要文本类型的值，将其转换成十六进制或者 Base64。</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line">import (</span><br><span class="line">    &quot;crypto/rand&quot;</span><br><span class="line">    // &quot;encoding/base64&quot;</span><br><span class="line">    // &quot;encoding/hex&quot;</span><br><span class="line">    &quot;fmt&quot;</span><br><span class="line">)</span><br><span class="line"></span><br><span class="line">func Key() string &#123;</span><br><span class="line">    buf := make([]byte, 16)</span><br><span class="line">    _, err := rand.Read(buf)</span><br><span class="line">    if err != nil &#123;</span><br><span class="line">        panic(err)  // out of randomness, should never happen</span><br><span class="line">    &#125;</span><br><span class="line">    return fmt.Sprintf(&quot;%x&quot;, buf)</span><br><span class="line">    // or hex.EncodeToString(buf)</span><br><span class="line">    // or base64.StdEncoding.EncodeToString(buf)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h2 id="声明空-Slice"><a href="#声明空-Slice" class="headerlink" title="声明空 Slice"></a>声明空 Slice</h2><p>声明空 Slice 时，使用</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">var t []string</span><br></pre></td></tr></table></figure>

<p>而不是</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">t := []string&#123;&#125;</span><br></pre></td></tr></table></figure>

<p>前者声明了一个值为 nil 的 Slice，后者不为 nil 但是长度为 0。它们的功能是一样的——它们的 <code>len</code> 和 <code>cap</code> 都是 0，但是前者依然是推荐的写法。</p>
<p>在几种有限的情况下推荐使用非 nil 但长度为 0 的 Slice（即后一种写法），比如说要 Encode 成 JSON 的时候（<code>nil</code> 会被 Encode 成 <code>null</code>, 而 <code>[]string&#123;&#125;</code> 会被 JSON 的 <code>[]</code>）。</p>
<h2 id="文档注释"><a href="#文档注释" class="headerlink" title="文档注释"></a>文档注释</h2><p>所有顶层的、可导出的名字都应该有注释，其他的类型和函数也应该注释。</p>
<h2 id="不要-Panic"><a href="#不要-Panic" class="headerlink" title="不要 Panic"></a>不要 Panic</h2><p>不要使用 panic 来进行正常的错误处理，使用 error 和多返回值。</p>
<h2 id="错误字符串"><a href="#错误字符串" class="headerlink" title="错误字符串"></a>错误字符串</h2><p>错误字符串不要以大写字母开头（除非是专有名词和缩写），不要以标点符号结尾。</p>
<h2 id="示例"><a href="#示例" class="headerlink" title="示例"></a>示例</h2><p>在添加新的 Package 时，应当包括示例：可以运行的示例，或演示完整调用过程的简单测试。</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">package stringutil_test</span><br><span class="line"></span><br><span class="line">import (</span><br><span class="line">    &quot;fmt&quot;</span><br><span class="line"></span><br><span class="line">    &quot;github.com/golang/example/stringutil&quot;</span><br><span class="line">)</span><br><span class="line"></span><br><span class="line">func ExampleReverse() &#123;</span><br><span class="line">    fmt.Println(stringutil.Reverse(&quot;hello&quot;))</span><br><span class="line">    // Output: olleh</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h2 id="Goroutine-生命周期"><a href="#Goroutine-生命周期" class="headerlink" title="Goroutine 生命周期"></a>Goroutine 生命周期</h2><p>当你开启一个 goroutine 时，弄清楚他们何时退出、是否能够退出。</p>
<p>通过阻塞 channel 的发送或接收可能会引起 goroutines 的内存泄漏：即使被阻塞的 channel 无法访问，垃圾收集器也不会终止 goroutine。</p>
<p>即使 goroutines 没有泄漏，当它们不再需要时却仍然将其留在内存中会导致其他细微且难以诊断的问题。往已经关闭的 channel 发送数据将会引发 panic。在“结果不被需要之后”修改仍在使用的输入仍然可能导致数据竞争。并且将 goroutines 留在内存中任意长时间将会导致不可预测的内存使用。</p>
<p>请尽量让并发代码足够简单，从而更容易地确认 goroutine 的生命周期。如果这不可行，请记录 goroutines 退出的时间和原因。</p>
<h2 id="错误处理"><a href="#错误处理" class="headerlink" title="错误处理"></a>错误处理</h2><p>不要使用 <code>_</code> 来丢弃 error。如果一个函数返回了 error，要检查他以确保函数调用成功。处理 error，返回 error，或者在特定情况下 panic。</p>
<h2 id="Package-导入"><a href="#Package-导入" class="headerlink" title="Package 导入"></a>Package 导入</h2><p>避免 Packge 导入时重命名，除非是为了防止名称冲突；好的 Package 名称不需要重命名。如果发生命名冲突，则更倾向于重命名最接近本地的 Package 或特定项目的 Package。</p>
<p>Package 导入按组进行组织，组与组之间有空行。标准库 Package 始终位于第一组中。</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">package main</span><br><span class="line"></span><br><span class="line">import (</span><br><span class="line">    &quot;fmt&quot;</span><br><span class="line">    &quot;hash/adler32&quot;</span><br><span class="line">    &quot;os&quot;</span><br><span class="line"></span><br><span class="line">    &quot;appengine/foo&quot;</span><br><span class="line">    &quot;appengine/user&quot;</span><br><span class="line"></span><br><span class="line">    &quot;github.com/foo/bar&quot;</span><br><span class="line">    &quot;rsc.io/goversion/version&quot;</span><br><span class="line">)</span><br></pre></td></tr></table></figure>

<p>goimports 会为你做这件事。</p>
<h2 id="命名返回参数"><a href="#命名返回参数" class="headerlink" title="命名返回参数"></a>命名返回参数</h2><p>想象一下以下示例在 godoc 中的样子。 命名返回参数:</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">func (n *Node) Parent1() (node *Node) &#123;&#125;</span><br><span class="line">func (n *Node) Parent2() (node *Node, err error) &#123;&#125;</span><br></pre></td></tr></table></figure>

<p>这样看起来啰啰嗦嗦，最好这样：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">func (n *Node) Parent1() *Node &#123;&#125;</span><br><span class="line">func (n *Node) Parent2() (*Node, error) &#123;&#125;</span><br></pre></td></tr></table></figure>

<p>但是，如果一个函数返回了 2 个或以上的相同类型的参数，或者从上下文中难以清楚地断定返回参数的含义，那么最好给返回参数命名。但是不要仅为了避免参数声明而命名结果参数，这得不偿失。</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">func (f *Foo) Location() (float64, float64, error)</span><br></pre></td></tr></table></figure>

<p>不如下边的代码清晰：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">// Location returns f&#x27;s latitude and longitude.</span><br><span class="line">// Negative values mean south and west, respectively.</span><br><span class="line">func (f *Foo) Location() (lat, long float64, err error)</span><br></pre></td></tr></table></figure>

<p>还有，在某些情况下，你需要命名结果参数，以便在延迟闭包中更改它，这也是可以的。</p>
<h2 id="Package-名字"><a href="#Package-名字" class="headerlink" title="Package 名字"></a>Package 名字</h2><p>Package 的所有调用都将使用该 Package 的字来完成，因此可以从标识符中省略该名称。例如，如果有一个 Package 叫做 chubby ，那么不要把类型命名为 ChubbyFile ，否则使用者将写为 chubby.ChubbyFile。而应该将该类型命名为 File，使用时将写为 chubby.File。避免使用无意义的包名称，如 util，common，misc，api，types 和 interfaces。</p>
<h2 id="Reciever-名"><a href="#Reciever-名" class="headerlink" title="Reciever 名"></a>Reciever 名</h2><p>一个 method 的 receiver 应该反映其身份，通常情况下 1 到 2 个字母的缩写就可以了（比如说 c、cl 作为 Client 的 receiver)。不要使用通用类的名字诸如 me、this 或者 self 这些。在 Go 中，method 的 receiver 的命名不必像 method 的其他参数一样那么具有描述性，因为他的角色显而易见、不必具有文档性。上下文要保持一致，如果你在一个 method 中使用 <code>c</code> 作为 receiver，不要在另外一个方法中使用 <code>cl</code>。</p>
<h2 id="变量名"><a href="#变量名" class="headerlink" title="变量名"></a>变量名</h2><p>在 Go 里，变量名应该尽量短而不是长。这一点在有限作用域的局部变量尤为必要。使用 <code>c</code> 而不是 <code>lineCount</code>，使用 <code>i</code> 而不是 <code>sliceIndex</code>。</p>
<p>基本规则：作用域越长的变量，其名字越应该更具有描述性。对于方法接收器（method receiver），一个或两个字母就足够了。循环下标、Reader 之类的名字可以是单个字母（i，r）。不常用的变量和全局变量则需要更具描述性的名称。</p>

      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="zh-CN">
    <link itemprop="mainEntityOfPage" href="https://www.gonever.com/2020/06/19/%E4%BF%AE%E6%94%B9%20Docker%20%E5%92%8C%20docker-compose%20%E4%B8%8B%20MySQL%20%E7%9A%84%E9%BB%98%E8%AE%A4%E5%AD%97%E7%AC%A6%E9%9B%86/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="Chen Gangyang">
      <meta itemprop="description" content="">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Castle，专属于自己的领地">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/2020/06/19/%E4%BF%AE%E6%94%B9%20Docker%20%E5%92%8C%20docker-compose%20%E4%B8%8B%20MySQL%20%E7%9A%84%E9%BB%98%E8%AE%A4%E5%AD%97%E7%AC%A6%E9%9B%86/" class="post-title-link" itemprop="url">修改 Docker 和 docker-compose 下 MySQL 的默认字符集</a>
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">发表于</span>

              <time title="创建时间：2020-06-19 16:21:35" itemprop="dateCreated datePublished" datetime="2020-06-19T16:21:35+08:00">2020-06-19</time>
            </span>
              <span class="post-meta-item">
                <span class="post-meta-item-icon">
                  <i class="far fa-calendar-check"></i>
                </span>
                <span class="post-meta-item-text">更新于</span>
                <time title="修改时间：2023-03-14 16:59:19" itemprop="dateModified" datetime="2023-03-14T16:59:19+08:00">2023-03-14</time>
              </span>

          

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <p>docker 中 MySQL 的默认编码为 latin1，这会导致中文乱码，因此我们需要修改 MySQL 的默认字符集。</p>
<p>我们可以通过以下几种方式来修改 MySQL 的默认字符集。</p>
<h2 id="修改配置文件"><a href="#修改配置文件" class="headerlink" title="修改配置文件"></a>修改配置文件</h2><p>我们可以通过修改配置文件的形式，来改变字符集。</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">[client]</span><br><span class="line">default-character-set=utf8mb4</span><br><span class="line"></span><br><span class="line">[mysql]</span><br><span class="line">default-character-set=utf8mb4</span><br><span class="line"></span><br><span class="line">[mysqld]</span><br><span class="line">collation-server = utf8mb4_unicode_ci</span><br><span class="line">character-set-server = utf8mb4</span><br></pre></td></tr></table></figure>

<h2 id="修改-docker-启动命令"><a href="#修改-docker-启动命令" class="headerlink" title="修改 docker 启动命令"></a>修改 docker 启动命令</h2><p>我们也可以通过修改 docker 命令来实现：</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">docker run mysql --name mysql --character-set-server=utf8mb4 --collation-server=utf8mb4_unicode_ci --skip-character-set-client-handshake</span><br></pre></td></tr></table></figure>

<h2 id="修改-docker-compose-配置文件"><a href="#修改-docker-compose-配置文件" class="headerlink" title="修改 docker-compose 配置文件"></a>修改 docker-compose 配置文件</h2><p>如果使用了 docker-compose，那么可以这样：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">mysql:</span><br><span class="line">    image: mysql:5.7</span><br><span class="line">    container_name: mysql</span><br><span class="line">    command: [&#x27;mysqld&#x27;, &#x27;--character-set-server=utf8mb4&#x27;, &#x27;--collation-server=utf8mb4_unicode_ci&#x27;, &#x27;--skip-character-set-client-handshake&#x27;]</span><br></pre></td></tr></table></figure>

<h2 id="附言"><a href="#附言" class="headerlink" title="附言"></a>附言</h2><p>特别地，我们来解释下 <code>skip-character-set-client-handshake</code> 命令的作用。</p>
<p>我们可以看下 MySQL 官方手册的如下片段：</p>
<blockquote>
<p><a target="_blank" rel="noopener" href="https://dev.mysql.com/doc/refman/8.0/en/server-options.html#option_mysqld_character-set-client-handshake">--character-set-client-handshake</a></p>
<p>Property</p>
<p>Value</p>
<p>Command-Line Format</p>
<p>`–character-set-client-handshake[&#x3D;{OFF</p>
<p>Type</p>
<p>Boolean</p>
<p>Default Value</p>
<p><code>ON</code></p>
<p>Do not ignore character set information sent by the client. To ignore client information and use the default server character set, use <a target="_blank" rel="noopener" href="https://dev.mysql.com/doc/refman/8.0/en/server-options.html#option_mysqld_character-set-client-handshake"><code>--skip-character-set-client-handshake</code></a>; this makes MySQL behave like MySQL 4.0.</p>
</blockquote>
<p>也就是说在默认情况下，MySQL 客户端是使用客户端设置的编码的。可以通过 <code>--skip-character-set-client-handshake</code> 来让客户端使用服务端的编码，来保持编码的一致性。因为我们 docker 里边多数情况下都是连接 docker 里边的 MySQL 服务，所以设置 <code>--skip-character-set-client-handshake</code> 是非常合理的一个情况，这样便不必单独再去设置客户端编码。</p>

      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="zh-CN">
    <link itemprop="mainEntityOfPage" href="https://www.gonever.com/2020/04/20/Golang%20%E7%9A%84%E7%86%94%E6%96%AD%E5%99%A8%E8%B0%83%E7%A0%94/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="Chen Gangyang">
      <meta itemprop="description" content="">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Castle，专属于自己的领地">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/2020/04/20/Golang%20%E7%9A%84%E7%86%94%E6%96%AD%E5%99%A8%E8%B0%83%E7%A0%94/" class="post-title-link" itemprop="url">Golang 的熔断器调研</a>
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">发表于</span>

              <time title="创建时间：2020-04-20 14:18:32" itemprop="dateCreated datePublished" datetime="2020-04-20T14:18:32+08:00">2020-04-20</time>
            </span>
              <span class="post-meta-item">
                <span class="post-meta-item-icon">
                  <i class="far fa-calendar-check"></i>
                </span>
                <span class="post-meta-item-text">更新于</span>
                <time title="修改时间：2023-03-11 11:33:26" itemprop="dateModified" datetime="2023-03-11T11:33:26+08:00">2023-03-11</time>
              </span>

          

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <h2 id="什么是雪崩效应？"><a href="#什么是雪崩效应？" class="headerlink" title="什么是雪崩效应？"></a>什么是雪崩效应？</h2><p>在微服务架构中通常会有多个服务层调用，基础服务的故障可能会导致级联故障，进而造成整个系统不可用的情况，这种现象被称为服务雪崩效应。<strong>服务雪崩效应</strong>是一种因<strong>服务提供者的不可用</strong>导致<strong>服务消费者的不可用</strong>，并将不可用逐渐放大的过程。</p>
<p>如果下图所示：A 作为服务提供者，B 为 A 的服务消费者，C 和 D 是 B 的服务消费者。A 不可用引起了 B 的不可用，并将不可用像滚雪球一样放大到 C 和 D 时，雪崩效应就形成了。</p>
<p>另外，在 A 不可用的情况下，由于 B 的重试会放大 A 的请求量，使 A 更加难以恢复。</p>
<p><img src="https://oss.gonever.com/phpShK1Bz5e9d3b61b0afe.png" alt="image.png"></p>
<h2 id="熔断器"><a href="#熔断器" class="headerlink" title="熔断器"></a>熔断器</h2><h3 id="概念"><a href="#概念" class="headerlink" title="概念"></a>概念</h3><p>熔断器模式可以有效防止对故障服务的不断重试，可以使服务调用者继续执行，不用等待错误的修正，或者浪费 CPU 等待超时发生。熔断器模式也可以使应用程序能够诊断错误是否已经修正，如果已经修正，应用程序会再次尝试调用操作。</p>
<h3 id="能力"><a href="#能力" class="headerlink" title="能力"></a>能力</h3><p>熔断器模式为远程服务提供的关键能力：</p>
<ul>
<li>快速失败<br>当远程服务处于降级状态时，应用程序将会快速失败，并防止通常会拖垮整个应用程序的资源耗尽问题的出现。在大多数中断情况下，最好是部分服务关闭而不是完全关闭。</li>
<li>优雅地失败<br>通过超时和快速失败，熔断器模式使应用程序开发人员有能力优雅地失败或提供替代方案。</li>
<li>无缝恢复<br>熔断器模式可以定期检查所请求的资源是否重新上线，并在没有认为干预的情况下重新允许对该资源进行访问。</li>
</ul>
<h3 id="实现"><a href="#实现" class="headerlink" title="实现"></a>实现</h3><ul>
<li>关闭状态(Closed)<br>在关闭状态下，熔断器会放行请求；通过计数器来判断当前的服务状态，当超过阈值时进入打开状态；当到达设定的间隔时间后会清空计数器，重新开始计数。</li>
<li>打开状态(Open)<br>在打开状态下，熔断器会拦截所有请求并返回失败；当到达熔断器的超时时间(timeout)后进入半打开状态。</li>
<li>半打开状态(Half-Open)<br>在半打开状态下，熔断器会放行设定的个数个请求，如果请求全部成功，则进入关闭状态；如果有任何失败，则进入打开状态。</li>
</ul>
<p><img src="https://oss.gonever.com/php2hXnQk5e9d3c1e7dfab.png" alt="image.png"><br><em>熔断器状态机</em></p>
<h3 id="熔断器的选型"><a href="#熔断器的选型" class="headerlink" title="熔断器的选型"></a>熔断器的选型</h3><ul>
<li><a target="_blank" rel="noopener" href="https://github.com/sony/gobreaker">github.com&#x2F;sony&#x2F;gobreaker</a></li>
<li><a target="_blank" rel="noopener" href="https://github.com/rubyist/circuitbreaker">github.com&#x2F;rubyist&#x2F;circuitbreaker</a></li>
<li><a target="_blank" rel="noopener" href="https://github.com/mercari/go-circuitbreaker">github.com&#x2F;mercari&#x2F;go-circuitbreaker</a></li>
</ul>
<p>对比项&#x2F;框架</p>
<p>sony&#x2F;gobreaker</p>
<p>rubyist&#x2F;circuitbreaker</p>
<p>mercari&#x2F;go-circuitbreaker</p>
<p>Stars</p>
<p>1.1k</p>
<p>867</p>
<p>193</p>
<p>Forks</p>
<p>79</p>
<p>94</p>
<p>7</p>
<p>Issues Opened</p>
<p>4</p>
<p>10</p>
<p>1</p>
<p>Issues Closed</p>
<p>9</p>
<p>15</p>
<p>0</p>
<p>Last Updated</p>
<p>2019-11-25</p>
<p>2019-10-21</p>
<p>2019-12-27</p>
<p>Latest Version</p>
<p>v0.4.1</p>
<p>v2.2.1</p>
<p>&#x2F;</p>
<p>Complexity</p>
<p>Easy</p>
<p>Complex</p>
<p>Middle</p>
<p>CancelContext Support</p>
<p>No</p>
<p>Yes</p>
<p>Yes</p>
<p>Deadline Support</p>
<p>No</p>
<p>Yes</p>
<p>Yes</p>
<p>Panel Support</p>
<p>No</p>
<p>Yes</p>
<p>No</p>
<p>External Call Support</p>
<p>No</p>
<p>Yes</p>
<p>Yes</p>
<p><strong><a target="_blank" rel="noopener" href="https://github.com/sony/gobreaker">github.com&#x2F;sony&#x2F;gobreaker</a></strong></p>
<p>优点：</p>
<ul>
<li>简单、实现了完整的熔断器</li>
<li>sony 出品、稳定、star 最多</li>
</ul>
<p>缺点：</p>
<ul>
<li>只支持传入 Func 的方式，如果返回错误则会判定为失败；如果忽略错误，则会在外层丢失错误。</li>
<li>不支持 CancelContext 和 Timeout，可能会将非上游的错误识别为上游错误。</li>
</ul>
<p><strong><a target="_blank" rel="noopener" href="https://github.com/rubyist/circuitbreaker">github.com&#x2F;rubyist&#x2F;circuitbreaker</a></strong></p>
<p>优点：</p>
<ul>
<li>提供了完整的熔断器实现，直接支持错误率和错误个数的配置。</li>
<li>提供了超时和 CancelContext 的支持。</li>
<li>提供了 Panel，在服务中用到多个熔断器的时候可简化实现。</li>
<li>提供了非 Func 方式的支持，便于自定义是否错误和返回正常的数据结构。</li>
</ul>
<p>缺点：</p>
<ul>
<li>实现相对复杂，学习成本较高。</li>
</ul>
<p><strong><a target="_blank" rel="noopener" href="https://github.com/mercari/go-circuitbreaker">github.com&#x2F;mercari&#x2F;go-circuitbreaker</a></strong></p>
<p>优点：</p>
<ul>
<li>供了完整的熔断器实现</li>
<li>提供了 CancelContext 和 DeadlineContext 的支持。</li>
<li>提供了 IgnoreErr 的支持，可以忽略部分错误。</li>
<li>提供了非 Func 方式的支持，便于自定义是否错误返回正常的数据结构。</li>
</ul>
<p>缺点：</p>
<ul>
<li>项目没有发布稳定版本的 tag。</li>
<li>issue 少，star 少，可能未得到充分验证。</li>
</ul>
<p>个人倾向于选择 <a href="github.com/rubyist/circuitbreaker">github.com&#x2F;rubyist&#x2F;circuitbreaker</a>。</p>

      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  


  
  <nav class="pagination">
    <a class="extend prev" rel="prev" href="/"><i class="fa fa-angle-left" aria-label="上一页"></i></a><a class="page-number" href="/">1</a><span class="page-number current">2</span><a class="page-number" href="/page/3/">3</a><span class="space">&hellip;</span><a class="page-number" href="/page/11/">11</a><a class="extend next" rel="next" href="/page/3/"><i class="fa fa-angle-right" aria-label="下一页"></i></a>
  </nav>



          </div>
          

<script>
  window.addEventListener('tabs:register', () => {
    let { activeClass } = CONFIG.comments;
    if (CONFIG.comments.storage) {
      activeClass = localStorage.getItem('comments_active') || activeClass;
    }
    if (activeClass) {
      let activeTab = document.querySelector(`a[href="#comment-${activeClass}"]`);
      if (activeTab) {
        activeTab.click();
      }
    }
  });
  if (CONFIG.comments.storage) {
    window.addEventListener('tabs:click', event => {
      if (!event.target.matches('.tabs-comment .tab-content .tab-pane')) return;
      let commentClass = event.target.classList[1];
      localStorage.setItem('comments_active', commentClass);
    });
  }
</script>

        </div>
          
  
  <div class="toggle sidebar-toggle">
    <span class="toggle-line toggle-line-first"></span>
    <span class="toggle-line toggle-line-middle"></span>
    <span class="toggle-line toggle-line-last"></span>
  </div>

  <aside class="sidebar">
    <div class="sidebar-inner">

      <ul class="sidebar-nav motion-element">
        <li class="sidebar-nav-toc">
          文章目录
        </li>
        <li class="sidebar-nav-overview">
          站点概览
        </li>
      </ul>

      <!--noindex-->
      <div class="post-toc-wrap sidebar-panel">
      </div>
      <!--/noindex-->

      <div class="site-overview-wrap sidebar-panel">
        <div class="site-author motion-element" itemprop="author" itemscope itemtype="http://schema.org/Person">
  <p class="site-author-name" itemprop="name">Chen Gangyang</p>
  <div class="site-description" itemprop="description"></div>
</div>
<div class="site-state-wrap motion-element">
  <nav class="site-state">
      <div class="site-state-item site-state-posts">
          <a href="/archives/">
        
          <span class="site-state-item-count">105</span>
          <span class="site-state-item-name">日志</span>
        </a>
      </div>
      <div class="site-state-item site-state-tags">
            <a href="/tags/">
          
        <span class="site-state-item-count">20</span>
        <span class="site-state-item-name">标签</span></a>
      </div>
  </nav>
</div>


  <div class="links-of-blogroll motion-element">
    <div class="links-of-blogroll-title"><i class="fa fa-link fa-fw"></i>
      Links
    </div>
    <ul class="links-of-blogroll-list">
        <li class="links-of-blogroll-item">
          <a href="https://www.silenceboy.com/" title="https:&#x2F;&#x2F;www.silenceboy.com&#x2F;" rel="noopener" target="_blank">silenceboychen的个人博客</a>
        </li>
    </ul>
  </div>

      </div>

    </div>
  </aside>
  <div id="sidebar-dimmer"></div>


      </div>
    </main>

    <footer class="footer">
      <div class="footer-inner">
        

        

<div class="copyright">
  
  &copy; 
  <span itemprop="copyrightYear">2023</span>
  <span class="with-love">
    <i class="fa fa-heart"></i>
  </span>
  <span class="author" itemprop="copyrightHolder">Chen Gangyang</span>
</div>
  <div class="powered-by">由 <a href="https://hexo.io/" class="theme-link" rel="noopener" target="_blank">Hexo</a> & <a href="https://theme-next.org/" class="theme-link" rel="noopener" target="_blank">NexT.Gemini</a> 强力驱动
  </div>

        








      </div>
    </footer>
  </div>

  
  <script src="/lib/anime.min.js"></script>
  <script src="/lib/velocity/velocity.min.js"></script>
  <script src="/lib/velocity/velocity.ui.min.js"></script>

<script src="/js/utils.js"></script>

<script src="/js/motion.js"></script>


<script src="/js/schemes/pisces.js"></script>


<script src="/js/next-boot.js"></script>




  















  

  

</body>
</html>
